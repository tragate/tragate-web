"use strict";$(function(){function t(){$(".products .product .img_wrapper img").each(function(){var n=$(this).prop("naturalWidth"),t=$(this).prop("naturalHeight"),i,r;n>t?($(this).height("calc(100%)"),i=n*$(this).height()/t,$(this).width(i)):($(this).width("calc(100%)"),r=t*$(this).width()/n,$(this).height(r))});setTimeout(function(){$(".products .loading").hide()},500)}Array.prototype.remove=function(){for(var n,t=arguments,i=t.length,r;i&&this.length;)for(n=t[--i];(r=this.indexOf(n))!=-1;)this.splice(r,1);return this};$.validator.setDefaults({ignore:[],errorElement:"label",errorClass:"error",errorPlacement:function(n,t){var i=$(t);i.parents(".form-group").append(n)}});$(".ShowTrageteModal").click(function(){$("#loading").show();var n=$(this).data();$(".modal-body").load(n.url,function(){setTimeout(function(){$("#TragateModal").modal({show:!0});typeof n.title!="undefined"&&$(".modal-title").html(n.title);$(".modal").find(".entry-header").hide();$("#loading").hide()},1e3)})});$.fn.extend({serializeFormJSON:function(n){var t={},i=this.serializeArray();return $.each(i,function(){t[this.name]?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value||"")):t[this.name]=this.value||""}),n?JSON.stringify(t):t}});$("form").keyup(function(n){n.keyCode==13&&$(this).find(".summernote").length==0&&$(this).find("button.button,input.button").click()});$("form.tragate").find("button,input[type=submit]").click(function(){var n={},t,i;if((n.btn=$(this),n.btn.hasClass("loading"))||(n.form=$(this).parents("form.tragate"),n.type=n.form.attr("method"),n.url=n.form.attr("action"),t=n.form.data(),i=n.form.serializeFormJSON(),!n.form.valid()))return!1;n.btn.addClass("loading");n.form.hasClass("ajax")&&jQuery.ajax({type:n.type,url:n.url,"async":!1,data:i,error:function(){toastr.error("Fatal Error !")},success:function(i){var r;i.success?i.links!=undefined?window.location=i.links:(toastr.success(i.message),n.btn.removeClass("loading"),t.reload&&setTimeout(function(){location.reload()},t.reloadtime)):(n.btn.removeClass("loading"),r=i.errors!=null?i.errors.join("<br/><br/>"):i.message,toastr.error(r))}})});var n=[];$("select.ajax").each(function(t){if(n[t]=$(this).data(),typeof n[t].change_to!="undefined"&&(n[t].change_to=$(n[t].change_to)),n[t].that=$(this),n[t].that.hasClass("multiple")&&(n[t].that.parent(".form-group").append('<div class="selected"><\/div>'),n[t].selected=n[t].that.parent(".form-group").find(".selected")),n[t].val_name=typeof n[t].val_name!="undefined"?n[t].val_name:"value",$.ajax({method:"Get",url:n[t].url}).then(function(i){if(i.success){if(n[t].that.html('<option value="" selected>Select<\/option>'),n[t].data=i.data,$.each(n[t].data,function(i,r){n[t].that.append('<option value="'+r.id+'">'+r[n[t].val_name]+"<\/option>")}),typeof n[t].current_val!="undefined"&&n[t].current_val!="0")if(n[t].that.hasClass("multiple")){n[t].selectedList=n[t].current_val!=""?n[t].current_val.toString().split(","):[];$.each(n[t].selectedList,function(i,r){var u=$.grep(n[t].data,function(n){return n.id==r})[0];n[t].selected.append("<span>"+u[n[t].val_name]+'<div data-id="'+r+'" data-value="'+u[n[t].val_name]+'" class="close" onclick="removeOption['+t+"](this,"+u.id+')">X<\/div><\/span>');n[t].that.find('option[value="'+u.id+'"]').remove()});n[t].that.on("change",function(){var r=$(this).find("option:selected"),i=r.val(),u=$.grep(n[t].data,function(n){return n.id==i})[0];r.remove();n[t].selectedList.push(i);$(n[t].val_to).val(n[t].selectedList.join(","));n[t].selected.append("<span>"+u[n[t].val_name]+'<div data-id="'+i+'" data-value="'+u[n[t].val_name]+'" class="close" onclick="removeOption['+t+"](this,"+i+')">X<\/div><\/span>')});removeOption[t]=function(i){var r=$(i).data();$(i).parent("span").remove();n[t].selectedList.remove(r.id.toString());$(n[t].val_to).val(n[t].selectedList.join(","));n[t].that.html('<option value="" selected>Select<\/option>');$.each(n[t].data,function(i,r){n[t].selectedList.indexOf(r.id)<0&&n[t].that.append('<option value="'+r.id+'">'+r[n[t].val_name]+"<\/option>")})}}else n[t].that.val(n[t].current_val).change()}else alert(res.message)}),typeof n[t].to_text!="undefined")n[t].that.on("change",function(){$(n[t].to_text).html($(this).find("option:selected").html())});if(typeof n[t].change_to!="undefined")n[t].that.on("change",function(){var i=n[t].change_to.data(),r,u;i.val_name=typeof i.val_name!="undefined"?i.val_name:"value";r=n[t].that.val();n[t].change_to.after('<div class="loading"><div class="bounce1"><\/div><div class="bounce2"><\/div><div class="bounce3"><\/div><\/div>');u=n[t].change_to.next(".loading");u.show();r!=""?$.ajax({method:"GET",url:i.url+r}).then(function(r){r.success?(n[t].change_to.html('<option value="" selected>Select<\/option>'),$.each(r.data,function(r,u){n[t].change_to.append('<option value="'+u.id+'">'+u[i.val_name]+"<\/option>")}),u.hide(),typeof i.current_val!="undefined"&&i.current_val!="-1"&&n[t].change_to.val(i.current_val)):alert(res.message)}):n[t].change_to.html('<option value="">Select<\/option>')})});setTimeout(function(){t()},500);$(window).resize(function(){t()})})(jQuery);